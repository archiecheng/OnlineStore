<% content_for :title, "Checkout" %>

<% if @order.nil? %>
  <div class="bg-white rounded-2xl border border-gray-100 shadow-md p-6">
    <p class="text-gray-700">No pending order found.</p>
    <div class="mt-3">
      <%= link_to "Back to products", products_path, class: "text-indigo-600 hover:text-indigo-800 font-medium" %>
    </div>
  </div>
  <% return %>
<% end %>

<div class="grid md:grid-cols-3 gap-6">
  <div class="md:col-span-2 bg-white rounded-2xl border border-gray-100 shadow-lg overflow-hidden">
    <div class="px-6 py-4 border-b border-gray-100">
      <h2 class="text-xl font-bold text-gray-900">Review items</h2>
      <p class="text-gray-600 text-sm">Confirm your order contents.</p>
    </div>
    <div class="divide-y divide-gray-100">
      <% @order.cart_items.each do |item| %>
        <%= render item %>
      <% end %>
    </div>
  </div>

  <div class="bg-white rounded-2xl border border-gray-100 shadow-lg p-6 space-y-4">
    <h3 class="text-lg font-semibold text-gray-900">Order Summary</h3>
    <div class="flex justify-between text-base font-semibold text-gray-900">
      <span>Subtotal</span>
      <span>$<%= @order.cart_items.sum { |item| item.product.price * item.quantity } %></span>
    </div>
    <p class="text-sm text-gray-500">Shipping address and payment method are not needed.</p>
    <%= render "form", order: @order %>
    <%= link_to "Continue shopping", products_path, class: "text-sm font-medium text-indigo-600 hover:text-indigo-800" %>
  </div>
</div>
